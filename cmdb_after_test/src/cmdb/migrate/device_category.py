# -*- coding: utf-8 -*-from models.device_category import DeviceCategoryfrom sqlalchemy import *from config import MIGRATE_DATABSE_URIfrom application import dbimport datetimeclass devicecatmigrate:    def run(self):        db.engine.execute("truncate table device_category")        engine = create_engine(MIGRATE_DATABSE_URI, encoding='utf-8',echo=True)        connection = engine.connect()        result = connection.execute("select `desc` from `type`")        tmplist=[]        if result:            for row in result:                tmp={'name':row['desc']}                tmplist.append(tmp)            for item in tmplist:                tmpinfo=DeviceCategory.query.filter(DeviceCategory.name==item['name']).first()                if tmpinfo:                    continue                tmptime=datetime.datetime.now().strftime("%Y-%m-%d %H:%M:%S")                target=DeviceCategory(item['name'],'','',0,tmptime,tmptime)                db.session.add(target)                db.session.commit()        connection.close()